---
import { AD_CLIENT } from "@/lib/constants";

interface Props {
  adSlot: string;
  adFormat?: string;
  adLayoutKey?: string;
  className?: string;
}

const { adSlot, adFormat = "auto", adLayoutKey, className } = Astro.props;
const isDev = import.meta.env.DEV;
---

<div class={className || "w-full empty:hidden [&:has(.adsbygoogle:empty)]:hidden"}>
  <ins
    class="adsbygoogle"
    style="display:block;text-align:center;"
    data-ad-client={AD_CLIENT}
    data-ad-slot={adSlot}
    data-ad-format={adFormat}
    data-full-width-responsive="true"
    {...(adLayoutKey ? { "data-ad-layout-key": adLayoutKey } : {})}
    {...(isDev ? { "data-adtest": "on" } : {})}
  ></ins>
  <script is:inline>
    (function() {
      try {
        (window.adsbygoogle = window.adsbygoogle || []).push({});
      } catch (e) {
        console.warn("[AdSense] Failed to push ad:", e);
      }
    })();
  </script>
</div>
